import{_ as X}from"./D4a6TBNS.js";import{_ as Y}from"./B0m9f-NN.js";import{f as Z,i as tt,j as p,k as C,l as z,u as et,c as o,a as t,b as k,w as M,g as s,t as i,p as st,h as b,d as f,B as P,F as at,m as lt,n as S,o as n,v as B}from"./sX_wM5Ua.js";import{u as V}from"./bGbag7Rw.js";import"./BHIvy5Tm.js";import"./DTcQ41cH.js";const rt={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-dark-300 dark:to-dark-200"},ot={class:"container mx-auto px-4 py-8"},nt={class:"mb-8"},dt={class:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-4"},it={class:"text-gray-900 dark:text-white"},ut={class:"flex items-center justify-between"},ct={class:"text-3xl lg:text-4xl font-poppins font-bold text-gray-900 dark:text-white mb-2"},gt={class:"text-lg text-gray-600 dark:text-gray-300"},vt={class:"mt-6"},pt={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-2"},xt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},mt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},bt={class:"lg:col-span-2"},yt={key:0,class:"card p-8 animate-pulse"},ht={key:1,class:"card p-8 text-center"},kt={class:"text-gray-600 dark:text-gray-400 mb-4"},ft={key:2,class:"space-y-6"},_t={class:"card p-8"},wt={class:"text-2xl font-semibold text-gray-900 dark:text-white mb-6"},$t={key:0,class:"mb-6"},Ct=["src","alt"],zt={class:"prose dark:prose-invert max-w-none mb-6"},Mt={class:"text-lg text-gray-700 dark:text-gray-300 leading-relaxed"},St={key:1,class:"bg-blue-50 dark:bg-blue-900 border-l-4 border-blue-400 p-4 rounded-r-lg mb-6"},Bt={class:"flex items-start space-x-3"},Vt={class:"text-blue-800 dark:text-blue-200"},Lt={key:2,class:"bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-400 p-4 rounded-r-lg mb-6"},Tt={class:"flex items-start space-x-3"},jt={class:"text-yellow-800 dark:text-yellow-200"},Nt={key:3,class:"bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-6"},At=["src"],It={class:"card p-6"},Dt={class:"flex items-center justify-between"},Ht={class:"text-center"},Ft={class:"space-x-3"},Et={key:3,class:"card p-8 text-center"},Rt={class:"space-y-6"},Pt={class:"card p-6"},Jt={class:"space-y-2"},Kt=["onClick"],qt={key:0,class:"card p-6"},Gt={class:"text-center"},ee={__name:"[step_id]",async setup(Ot){let u,x;const _=Z(),J=tt(),g=p(()=>_.params.id),m=p(()=>_.params.error_id),L=p(()=>_.params.step_id),{data:y}=([u,x]=C(()=>V(`/api/devices/${g.value}`,"$TyyhoiTgJs")),u=await u,x(),u),{data:h}=([u,x]=C(()=>V(`/api/errors/${g.value}`,"$mKLHgupuoC")),u=await u,x(),u),{data:d,pending:T,error:j,refresh:K}=([u,x]=C(()=>V(`/api/steps/${g.value}/${m.value}`,"$kaM34hbjjD")),u=await u,x(),u),a=p(()=>!d.value||!L.value?0:d.value.findIndex(l=>l.id==L.value)),r=p(()=>!d.value||a.value===-1?null:d.value[a.value]),q=p(()=>!h.value||!Array.isArray(h.value)?null:h.value.find(l=>l.id==m.value)),G=()=>{J.back()},O=()=>{S(`/diagnostic/${g.value}/${m.value}`)},w=l=>{if(!d.value||!d.value[l])return;const e=d.value[l];S(`/devices/${g.value}/errors/${m.value}/steps/${e.id}`)},Q=()=>{a.value>0&&w(a.value-1)},N=()=>{var l;a.value<(((l=d.value)==null?void 0:l.length)||0)-1&&w(a.value+1)},A=l=>{var e;console.log(`Step ${a.value+1} marked as:`,l?"successful":"failed"),l&&a.value<(((e=d.value)==null?void 0:e.length)||0)-1&&setTimeout(()=>{N()},500)},U=()=>{console.log("Diagnostic completed"),S(`/devices/${g.value}/errors/${m.value}?completed=true`)};if(!y.value)throw z({statusCode:404,statusMessage:"Устройство не найдено"});if(!q.value)throw z({statusCode:404,statusMessage:"Ошибка не найдена"});if(!r.value&&!T.value)throw z({statusCode:404,statusMessage:"Шаг не найден"});return et({title:p(()=>{var l,e;return`Шаг ${a.value+1}: ${(l=r.value)==null?void 0:l.title} - ${(e=y.value)==null?void 0:e.name}`}),meta:[{name:"description",content:p(()=>{var l;return`Пошаговая инструкция: ${(l=r.value)==null?void 0:l.instruction}`})}]}),(l,e)=>{var I,D,H,F,E,R;const $=X,W=Y;return n(),o("div",rt,[t("div",ot,[t("div",nt,[t("nav",dt,[k($,{to:"/devices",class:"hover:text-primary-600"},{default:M(()=>e[3]||(e[3]=[f("Устройства")])),_:1,__:[3]}),e[4]||(e[4]=t("span",null,"→",-1)),k($,{to:`/devices/${s(g)}/errors`,class:"hover:text-primary-600"},{default:M(()=>{var c;return[f(i((c=s(y))==null?void 0:c.name),1)]}),_:1},8,["to"]),e[5]||(e[5]=t("span",null,"→",-1)),k($,{to:`/devices/${s(g)}/errors/${s(m)}`,class:"hover:text-primary-600"},{default:M(()=>{var c;return[f(i((c=s(h))==null?void 0:c.title),1)]}),_:1},8,["to"]),e[6]||(e[6]=t("span",null,"→",-1)),t("span",it,"Шаг "+i(s(a)+1),1)]),t("div",ut,[t("div",null,[t("h1",ct,i((I=s(r))==null?void 0:I.title),1),t("p",gt," Шаг "+i(s(a)+1)+" из "+i(((D=s(d))==null?void 0:D.length)||0),1)]),t("div",{class:"flex space-x-4"},[t("button",{onClick:G,class:"btn-secondary"}," ← Назад "),t("button",{onClick:O,class:"btn-primary"}," 🚀 Полная диагностика ")])]),t("div",vt,[t("div",pt,[e[7]||(e[7]=t("span",null,"Прогресс диагностики",-1)),t("span",null,i(Math.round((s(a)+1)/(((H=s(d))==null?void 0:H.length)||1)*100))+"%",1)]),t("div",xt,[t("div",{class:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:st(`width: ${(s(a)+1)/(((F=s(d))==null?void 0:F.length)||1)*100}%`)},null,4)])])]),t("div",mt,[t("div",bt,[s(T)?(n(),o("div",yt,e[8]||(e[8]=[t("div",{class:"h-8 bg-gray-200 dark:bg-gray-700 rounded mb-4"},null,-1),t("div",{class:"h-64 bg-gray-200 dark:bg-gray-700 rounded mb-6"},null,-1),t("div",{class:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-2"},null,-1),t("div",{class:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-2/3"},null,-1)]))):s(j)?(n(),o("div",ht,[e[9]||(e[9]=t("div",{class:"text-red-500 mb-4"},[t("svg",{class:"w-12 h-12 mx-auto",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),e[10]||(e[10]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," Ошибка загрузки шага ",-1)),t("p",kt,i(s(j).message),1),t("button",{onClick:e[0]||(e[0]=c=>s(K)()),class:"btn-primary"}," Попробовать снова ")])):s(r)?(n(),o("div",ft,[t("div",_t,[t("h2",wt,i(s(r).title),1),s(r).screen_image?(n(),o("div",$t,[t("img",{src:s(r).screen_image,alt:s(r).title,class:"w-full max-w-2xl mx-auto rounded-lg shadow-lg"},null,8,Ct)])):b("",!0),t("div",zt,[t("p",Mt,i(s(r).instruction),1)]),s(r).tip?(n(),o("div",St,[t("div",Bt,[e[12]||(e[12]=t("svg",{class:"w-6 h-6 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-1",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),t("div",null,[e[11]||(e[11]=t("h4",{class:"font-medium text-blue-900 dark:text-blue-100 mb-1"},"Полезная подсказка",-1)),t("p",Vt,i(s(r).tip),1)])])])):b("",!0),s(r).highlighted_button?(n(),o("div",Lt,[t("div",Tt,[e[15]||(e[15]=t("svg",{class:"w-6 h-6 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-1",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"})],-1)),t("div",null,[e[14]||(e[14]=t("h4",{class:"font-medium text-yellow-900 dark:text-yellow-100 mb-1"},"Кнопка для нажатия",-1)),t("p",jt,[e[13]||(e[13]=f("Найдите и нажмите кнопку: ")),t("strong",null,i(s(r).highlighted_button),1)])])])])):b("",!0),s(r).audio_url?(n(),o("div",Nt,[e[16]||(e[16]=t("div",{class:"flex items-center space-x-3 mb-3"},[t("svg",{class:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"})]),t("h4",{class:"font-medium text-purple-900 dark:text-purple-100"},"Аудио-инструкция")],-1)),t("audio",{controls:"",class:"w-full",src:s(r).audio_url}," Ваш браузер не поддерживает аудио. ",8,At)])):b("",!0)]),t("div",It,[t("div",Dt,[t("div",null,[s(a)>0?(n(),o("button",{key:0,onClick:Q,class:"btn-secondary"}," ← Предыдущий шаг ")):b("",!0)]),t("div",Ht,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-2"}," Выполнили этот шаг? ",-1)),t("div",Ft,[t("button",{onClick:e[1]||(e[1]=c=>A(!1)),class:"px-4 py-2 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-lg hover:bg-red-200 dark:hover:bg-red-800 transition-colors"}," ❌ Не помогло "),t("button",{onClick:e[2]||(e[2]=c=>A(!0)),class:"px-4 py-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hover:bg-green-200 dark:hover:bg-green-800 transition-colors"}," ✅ Помогло ")])]),t("div",null,[s(a)<(((E=s(d))==null?void 0:E.length)||0)-1?(n(),o("button",{key:0,onClick:N,class:"btn-primary"}," Следующий шаг → ")):(n(),o("button",{key:1,onClick:U,class:"btn-primary"}," Завершить ✨ "))])])])])):(n(),o("div",Et,e[18]||(e[18]=[P('<div class="text-gray-400 mb-4"><svg class="w-12 h-12 mx-auto" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div><h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2"> Шаг не найден </h3><p class="text-gray-600 dark:text-gray-400"> Запрашиваемый шаг диагностики не существует </p>',3)])))]),t("div",Rt,[t("div",Pt,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Все шаги",-1)),t("div",Jt,[(n(!0),o(at,null,lt(s(d),(c,v)=>(n(),o("div",{key:c.id,class:B(["flex items-center space-x-3 p-2 rounded-lg cursor-pointer",{"bg-primary-100 dark:bg-primary-900":v===s(a),"hover:bg-gray-100 dark:hover:bg-gray-800":v!==s(a)}]),onClick:Qt=>w(v)},[t("div",{class:B(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-semibold",{"bg-primary-600 text-white":v===s(a),"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400":v!==s(a)}])},i(v+1),3),t("span",{class:B(["text-sm truncate",{"text-primary-900 dark:text-primary-100 font-medium":v===s(a),"text-gray-600 dark:text-gray-400":v!==s(a)}])},i(c.title),3)],10,Kt))),128))])]),s(y)?(n(),o("div",qt,[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Пульт управления",-1)),t("div",Gt,[k(W,{device:s(y),"highlighted-button":(R=s(r))==null?void 0:R.highlighted_button,class:"max-w-48 mx-auto"},null,8,["device","highlighted-button"]),e[20]||(e[20]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2"}," Интерактивный пульт для помощи ",-1))])])):b("",!0),e[22]||(e[22]=P('<div class="card p-6"><h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Нужна помощь?</h3><div class="space-y-3"><button class="w-full btn-secondary text-left text-sm"> 📞 Связаться с поддержкой </button><button class="w-full btn-secondary text-left text-sm"> 💬 Открыть чат </button><button class="w-full btn-secondary text-left text-sm"> 📖 Руководство пользователя </button></div></div>',1))])])])])}}};export{ee as default};
