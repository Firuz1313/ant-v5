import{r as L,j as D,e as be,c as l,o,a as e,D as Z,t as c,g as t,x as b,C as A,y as T,F as S,m as U,A as G,h as m,E as fe,v as J,q as ve,z as W,b as B,w as P,d as q,k as K,u as he,s as ee}from"./sX_wM5Ua.js";import{_ as te}from"./DlAUqK2U.js";import{u as X}from"./bGbag7Rw.js";import"./BHIvy5Tm.js";import"./DTcQ41cH.js";const ke={class:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-start justify-center p-4"},we={class:"bg-white dark:bg-dark-100 rounded-xl shadow-2xl max-w-4xl w-full max-h-screen overflow-y-auto"},_e={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},$e={class:"flex items-center justify-between"},Ce={class:"text-lg font-semibold text-gray-900 dark:text-white"},Se={class:"px-6 py-4 space-y-6"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Oe=["value"],Me=["value"],Le={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Re={key:0,class:"text-center py-8 text-gray-500"},Ve={key:1,class:"space-y-3"},Ee={class:"text-sm font-medium text-gray-500"},Fe=["onUpdate:modelValue"],Ae=["value"],De=["onUpdate:modelValue"],Ie=["onClick"],Ne={class:"bg-blue-50 dark:bg-blue-900 rounded-lg p-4"},ze={class:"flex items-center space-x-3 mb-4"},Be={class:"flex items-center space-x-3 mb-4"},Pe={class:"mb-4"},Te={class:"flex items-center space-x-3 mb-2"},qe={key:0,class:"ml-7 space-y-2"},He={class:"space-y-2"},We=["onUpdate:modelValue"],Ge=["onUpdate:modelValue"],Je=["onClick"],Ke={class:"mb-4"},Xe={class:"flex items-center space-x-3 mb-2"},Ze={key:0,class:"ml-7 space-y-2"},Qe={class:"bg-green-50 dark:bg-green-900 rounded-lg p-4"},Ye={class:"mb-4"},et={key:0,class:"mt-2"},tt=["src"],rt={class:"mb-4"},st={key:0},ot=["accept"],lt={class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"},at=["disabled"],dt={__name:"StepEditor",props:{step:{type:Object,default:null},devices:{type:Array,default:()=>[]},errors:{type:Array,default:()=>[]}},emits:["close","save"],setup(I,{emit:$}){const v=I,h=$,R=L(!1),a=L({title:"",order_index:1,device_id:"",error_id:"",instruction:"",tip:"",screen_image:null,actions:[],onlyForOperator:!1,progress:!1,hasConfirmation:!1,userConfirmation:{question:"",options:[{text:"Да",action:"next"},{text:"Нет",action:"alternative"}]},hasAlternative:!1,ifNoResult:{description:"",nextStepId:""},media:{type:"",url:null,description:""},audio_url:null}),O=[{id:"power",label:"⏻ POWER"},{id:"source",label:"📺 SOURCE"},{id:"menu",label:"☰ MENU"},{id:"exit",label:"✕ EXIT"},{id:"info",label:"ℹ INFO"},{id:"ok",label:"✓ OK"},{id:"up",label:"↑ UP"},{id:"down",label:"↓ DOWN"},{id:"left",label:"← LEFT"},{id:"right",label:"→ RIGHT"},{id:"vol-up",label:"🔊 VOL+"},{id:"vol-down",label:"🔉 VOL-"},{id:"ch-up",label:"📺 CH+"},{id:"ch-down",label:"📺 CH-"},...Array.from({length:10},(x,s)=>({id:`num-${s}`,label:`${s}`}))],p=D(()=>!!v.step),E=D(()=>a.value.device_id?v.errors.filter(x=>x.device_id==a.value.device_id):[]);be(()=>{v.step&&Object.assign(a.value,{...v.step,actions:v.step.actions||[],hasConfirmation:!!v.step.userConfirmation,hasAlternative:!!v.step.ifNoResult,userConfirmation:v.step.userConfirmation||a.value.userConfirmation,ifNoResult:v.step.ifNoResult||a.value.ifNoResult,media:v.step.media||a.value.media})});const N=()=>{a.value.actions.push({buttonId:"",description:""})},C=x=>{a.value.actions.splice(x,1)},F=()=>{a.value.userConfirmation.options.push({text:"",action:"next"})},z=x=>{a.value.userConfirmation.options.length>1&&a.value.userConfirmation.options.splice(x,1)},w=x=>{switch(x){case"image":return"image/*";case"video":return"video/*";case"animation":return"image/gif";default:return"*/*"}},n=x=>{const s=x.target.files[0];if(s){const i=new FileReader;i.onload=M=>{a.value.screen_image=M.target.result},i.readAsDataURL(s)}},g=x=>{const s=x.target.files[0];if(s){const i=new FileReader;i.onload=M=>{a.value.media.url=M.target.result},i.readAsDataURL(s)}},f=x=>{const s=x.target.files[0];if(s){const i=new FileReader;i.onload=M=>{a.value.audio_url=M.target.result},i.readAsDataURL(s)}},k=async()=>{R.value=!0;try{const x={...a.value};x.hasConfirmation||delete x.userConfirmation,x.hasAlternative||delete x.ifNoResult,x.media.type||delete x.media,delete x.hasConfirmation,delete x.hasAlternative,h("save",x)}catch(x){console.error("Error saving step:",x),alert("Ошибка при сохранении шага")}finally{R.value=!1}};return(x,s)=>(o(),l("div",ke,[e("div",we,[e("form",{onSubmit:Z(k,["prevent"]),onClick:s[17]||(s[17]=Z(()=>{},["stop"]))},[e("div",_e,[e("div",$e,[e("h3",Ce,c(t(p)?"Редактировать шаг":"Создать новый шаг"),1),e("button",{type:"button",onClick:s[0]||(s[0]=i=>x.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},s[18]||(s[18]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])]),e("div",Se,[e("div",Ue,[e("div",null,[s[19]||(s[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название шага * ",-1)),b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>t(a).title=i),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"Например: Проверка карты доступа"},null,512),[[A,t(a).title]])]),e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Порядковый номер ",-1)),b(e("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>t(a).order_index=i),type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,512),[[A,t(a).order_index,void 0,{number:!0}]])])]),e("div",je,[e("div",null,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Приставка * ",-1)),b(e("select",{"onUpdate:modelValue":s[3]||(s[3]=i=>t(a).device_id=i),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},[s[21]||(s[21]=e("option",{value:""},"Выберите приставку",-1)),(o(!0),l(S,null,U(I.devices,i=>(o(),l("option",{key:i.id,value:i.id},c(i.name),9,Oe))),128))],512),[[T,t(a).device_id]])]),e("div",null,[s[24]||(s[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Ошибка * ",-1)),b(e("select",{"onUpdate:modelValue":s[4]||(s[4]=i=>t(a).error_id=i),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},[s[23]||(s[23]=e("option",{value:""},"Выберите ошибку",-1)),(o(!0),l(S,null,U(t(E),i=>(o(),l("option",{key:i.id,value:i.id},c(i.title),9,Me))),128))],512),[[T,t(a).error_id]])])]),e("div",null,[s[25]||(s[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Инструкция * ",-1)),b(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=i=>t(a).instruction=i),required:"",rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"Подробное описание того, что должен сделать пользователь"},null,512),[[A,t(a).instruction]])]),e("div",null,[s[26]||(s[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Подсказка (необязательно) ",-1)),b(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=i=>t(a).tip=i),rows:"2",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"Дополнительная подсказка для пользователя"},null,512),[[A,t(a).tip]])]),e("div",Le,[e("div",{class:"flex items-center justify-between mb-4"},[s[27]||(s[27]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white"}," 🎮 Действия с пультом ",-1)),e("button",{type:"button",onClick:N,class:"btn-secondary text-sm"}," + Добавить кнопку ")]),t(a).actions.length===0?(o(),l("div",Re," Нет действий с пультом ")):(o(),l("div",Ve,[(o(!0),l(S,null,U(t(a).actions,(i,M)=>(o(),l("div",{key:M,class:"flex items-center space-x-3 p-3 bg-white dark:bg-gray-700 rounded border"},[e("span",Ee,c(M+1)+".",1),b(e("select",{"onUpdate:modelValue":j=>i.buttonId=j,class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},[s[28]||(s[28]=e("option",{value:""},"Выберите кнопку",-1)),(o(),l(S,null,U(O,j=>e("option",{key:j.id,value:j.id},c(j.label),9,Ae)),64))],8,Fe),[[T,i.buttonId]]),b(e("input",{"onUpdate:modelValue":j=>i.description=j,type:"text",placeholder:"Описание действия",class:"flex-2 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,8,De),[[A,i.description]]),e("button",{type:"button",onClick:j=>C(M),class:"text-red-600 hover:text-red-800"},s[29]||(s[29]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Ie)]))),128))]))]),e("div",Ne,[s[38]||(s[38]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"}," ⚙️ Расширенные функции ",-1)),e("div",ze,[b(e("input",{"onUpdate:modelValue":s[7]||(s[7]=i=>t(a).onlyForOperator=i),type:"checkbox",id:"operatorOnly",class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,512),[[G,t(a).onlyForOperator]]),s[30]||(s[30]=e("label",{for:"operatorOnly",class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 🔒 Только для операторов ",-1)),s[31]||(s[31]=e("span",{class:"text-xs text-gray-500"},"Шаг будет виден только в режиме оператора",-1))]),e("div",Be,[b(e("input",{"onUpdate:modelValue":s[8]||(s[8]=i=>t(a).progress=i),type:"checkbox",id:"progress",class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,512),[[G,t(a).progress]]),s[32]||(s[32]=e("label",{for:"progress",class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," ⏳ Показать прогресс ",-1)),s[33]||(s[33]=e("span",{class:"text-xs text-gray-500"},"Отображать индикатор загрузки",-1))]),e("div",Pe,[e("div",Te,[b(e("input",{"onUpdate:modelValue":s[9]||(s[9]=i=>t(a).hasConfirmation=i),type:"checkbox",id:"confirmation",class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,512),[[G,t(a).hasConfirmation]]),s[34]||(s[34]=e("label",{for:"confirmation",class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," ❓ Требует подтверждения от пользователя ",-1))]),t(a).hasConfirmation?(o(),l("div",qe,[b(e("input",{"onUpdate:modelValue":s[10]||(s[10]=i=>t(a).userConfirmation.question=i),type:"text",placeholder:"Вопрос для пользователя",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,512),[[A,t(a).userConfirmation.question]]),e("div",He,[(o(!0),l(S,null,U(t(a).userConfirmation.options,(i,M)=>(o(),l("div",{key:M,class:"flex items-center space-x-2"},[b(e("input",{"onUpdate:modelValue":j=>i.text=j,type:"text",placeholder:"Вариант ответа",class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,8,We),[[A,i.text]]),b(e("select",{"onUpdate:modelValue":j=>i.action=j,class:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},s[35]||(s[35]=[e("option",{value:"next"},"Следующий шаг",-1),e("option",{value:"alternative"},"Альтернативный путь",-1),e("option",{value:"completion"},"Завершение",-1),e("option",{value:"restart"},"Начать заново",-1)]),8,Ge),[[T,i.action]]),e("button",{type:"button",onClick:j=>z(M),class:"text-red-600 hover:text-red-800"},s[36]||(s[36]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Je)]))),128)),e("button",{type:"button",onClick:F,class:"text-sm text-primary-600 hover:text-primary-700"}," + Добавить вариант ")])])):m("",!0)]),e("div",Ke,[e("div",Xe,[b(e("input",{"onUpdate:modelValue":s[11]||(s[11]=i=>t(a).hasAlternative=i),type:"checkbox",id:"alternative",class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,512),[[G,t(a).hasAlternative]]),s[37]||(s[37]=e("label",{for:"alternative",class:"text-sm font-medium text-gray-700 dark:text-gray-300"},' 🔄 Альтернативный сценарий "Если не помогло" ',-1))]),t(a).hasAlternative?(o(),l("div",Ze,[b(e("input",{"onUpdate:modelValue":s[12]||(s[12]=i=>t(a).ifNoResult.description=i),type:"text",placeholder:"Описание альтернативного пути",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,512),[[A,t(a).ifNoResult.description]]),b(e("input",{"onUpdate:modelValue":s[13]||(s[13]=i=>t(a).ifNoResult.nextStepId=i),type:"text",placeholder:"ID следующего шага",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,512),[[A,t(a).ifNoResult.nextStepId]])])):m("",!0)])]),e("div",Qe,[s[43]||(s[43]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"}," 🎥 Медиа-контент ",-1)),e("div",Ye,[s[39]||(s[39]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Изображение экрана ТВ ",-1)),e("input",{type:"file",accept:"image/*",onChange:n,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,32),t(a).screen_image?(o(),l("div",et,[e("img",{src:t(a).screen_image,alt:"Screen preview",class:"w-32 h-24 object-cover rounded border"},null,8,tt)])):m("",!0)]),e("div",rt,[s[41]||(s[41]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Дополнительное медиа (видео/анимация) ",-1)),b(e("select",{"onUpdate:modelValue":s[14]||(s[14]=i=>t(a).media.type=i),class:"w-full mb-2 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},s[40]||(s[40]=[e("option",{value:""},"Без дополнительного медиа",-1),e("option",{value:"image"},"Изображение",-1),e("option",{value:"video"},"Видео",-1),e("option",{value:"animation"},"Анимация (GIF)",-1)]),512),[[T,t(a).media.type]]),t(a).media.type?(o(),l("div",st,[e("input",{type:"file",accept:w(t(a).media.type),onChange:g,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,40,ot),b(e("input",{"onUpdate:modelValue":s[15]||(s[15]=i=>t(a).media.description=i),type:"text",placeholder:"Описание медиа",class:"w-full mt-2 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white text-sm"},null,512),[[A,t(a).media.description]])])):m("",!0)]),e("div",null,[s[42]||(s[42]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Аудио-подсказка ",-1)),e("input",{type:"file",accept:"audio/*",onChange:f,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,32)])])]),e("div",lt,[e("button",{type:"button",onClick:s[16]||(s[16]=i=>x.$emit("close")),class:"btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:t(R),class:"btn-primary"},c(t(R)?"Сохранение...":"Сохранить"),9,at)])],32)])]))}},it={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full animate-ping"},nt={__name:"PreviewRemoteButton",props:{buttonId:{type:String,required:!0},highlighted:{type:Boolean,default:!1}},setup(I){const $=I,v=()=>{console.log("Preview button pressed:",$.buttonId)};return(h,R)=>(o(),l("div",{class:J(["relative transition-all duration-200 cursor-pointer",{"ring-4 ring-yellow-400 ring-opacity-75 animate-pulse":I.highlighted}]),onClick:v},[fe(h.$slots,"default",{},void 0,!0),I.highlighted?(o(),l("div",it)):m("",!0)],2))}},ut=te(nt,[["__scopeId","data-v-e84b0e6d"]]),ct={class:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4"},pt={class:"bg-white dark:bg-dark-100 rounded-xl shadow-2xl max-w-6xl w-full max-h-screen overflow-y-auto"},gt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},xt={class:"flex items-center justify-between"},mt={class:"flex items-center space-x-3"},yt={class:"p-6"},bt={class:"mb-6"},ft=["value","disabled"],vt={key:0,class:"border rounded-lg p-6 bg-gray-50 dark:bg-gray-800"},ht={class:"flex items-center justify-between mb-6"},kt={class:"flex items-center space-x-2"},wt={class:"text-sm text-gray-600 dark:text-gray-400"},_t={key:0,class:"px-2 py-1 text-xs bg-orange-100 text-orange-800 dark:bg-orange-800 dark:text-orange-100 rounded-full"},$t={class:"flex space-x-1"},Ct=["title"],St={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ut={class:"tv-screen-container"},jt={class:"tv-screen bg-black rounded-lg border-8 border-gray-800 shadow-2xl relative overflow-hidden",style:{"aspect-ratio":"16/9"}},Ot={key:0,class:"w-full h-full"},Mt=["src"],Lt=["src","alt"],Rt=["src","alt"],Vt=["src","alt"],Et={key:2,class:"w-full h-full flex items-center justify-center"},Ft={class:"text-center text-white"},At={class:"text-sm"},Dt={class:"remote-container"},It={class:"card p-4"},Nt={key:0,class:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg"},zt={class:"text-sm text-blue-700 dark:text-blue-300 space-y-1"},Bt={class:"flex-shrink-0 w-5 h-5 bg-blue-600 text-white text-xs rounded-full flex items-center justify-center"},Pt={class:"bg-gray-900 rounded-2xl p-4 max-w-xs mx-auto"},Tt={class:"text-center mb-4"},qt={class:"relative w-24 h-24 mx-auto mb-4"},Ht={class:"grid grid-cols-2 gap-2 mb-4"},Wt={class:"grid grid-cols-3 gap-1"},Gt={class:"mt-6 card p-4"},Jt={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},Kt={class:"flex-1"},Xt={class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"},Zt={class:"text-gray-600 dark:text-gray-400 mb-4"},Qt={key:0,class:"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-3 mb-4"},Yt={class:"flex items-start space-x-2"},er={class:"text-sm text-blue-800 dark:text-blue-200"},tr={key:1,class:"bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4 mb-4"},rr={class:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-3"},sr={class:"space-y-2"},or={key:2,class:"bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-3"},lr={class:"flex items-start space-x-2"},ar={class:"text-sm text-purple-700 dark:text-purple-300"},dr={class:"flex items-center space-x-3 lg:ml-6"},ir={key:1,class:"text-center py-12 text-gray-500"},nr={__name:"StepPreview",props:{steps:{type:Array,default:()=>[]},operatorMode:{type:Boolean,default:!1}},emits:["close"],setup(I,{emit:$}){const v=I,h=L(0),R=L(v.operatorMode),a=D({get:()=>R.value,set:w=>{R.value=w}}),O=D(()=>v.steps.filter(w=>!w.onlyForOperator||a.value)),p=D(()=>O.value[h.value]||null),E=()=>{a.value=!a.value,h.value=0},N=w=>w<h.value?"bg-green-500":w===h.value?"bg-primary-500":"bg-gray-300 dark:bg-gray-600",C=w=>p.value?p.value.actions?p.value.actions.some(n=>n.buttonId===w):p.value.highlighted_buttons?p.value.highlighted_buttons.includes(w):!1:!1,F=()=>{h.value<O.value.length-1&&h.value++},z=()=>{h.value>0&&h.value--};return ve(()=>v.operatorMode,w=>{a.value=w}),(w,n)=>{const g=ut;return o(),l("div",ct,[e("div",pt,[e("div",gt,[e("div",xt,[n[3]||(n[3]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," 👁️ Предпросмотр диагностики ",-1)),e("div",mt,[e("button",{onClick:E,class:J(["px-3 py-1 rounded text-sm font-medium transition-colors",t(a)?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"])},c(t(a)?"👤 Оператор":"👥 Пользователь"),3),e("button",{onClick:n[0]||(n[0]=f=>w.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},n[2]||(n[2]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])]),e("div",yt,[e("div",bt,[n[4]||(n[4]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Выберите шаг для предпросмотра: ",-1)),b(e("select",{"onUpdate:modelValue":n[1]||(n[1]=f=>W(h)?h.value=f:null),class:"w-full max-w-md px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},[(o(!0),l(S,null,U(t(O),(f,k)=>(o(),l("option",{key:f.id,value:k,disabled:f.onlyForOperator&&!t(a)}," Шаг "+c(f.order_index)+": "+c(f.title)+" "+c(f.onlyForOperator?" 🔒":""),9,ft))),128))],512),[[T,t(h)]])]),t(p)?(o(),l("div",vt,[e("div",ht,[e("div",kt,[e("span",wt," Шаг "+c(t(h)+1)+" из "+c(t(O).length),1),t(p).onlyForOperator?(o(),l("span",_t," 🔒 Только для оператора ")):m("",!0)]),e("div",$t,[(o(!0),l(S,null,U(t(O),(f,k)=>(o(),l("div",{key:k,class:J(["w-3 h-3 rounded-full transition-colors",N(k)]),title:f.title},null,10,Ct))),128))])]),e("div",St,[e("div",Ut,[e("div",jt,[t(p).media?(o(),l("div",Ot,[t(p).media.type==="video"?(o(),l("video",{key:0,src:t(p).media.url,class:"w-full h-full object-cover",controls:"",muted:""},null,8,Mt)):t(p).media.type==="animation"?(o(),l("img",{key:1,src:t(p).media.url,alt:t(p).media.description,class:"w-full h-full object-cover"},null,8,Lt)):t(p).media.type==="image"?(o(),l("img",{key:2,src:t(p).media.url,alt:t(p).title,class:"w-full h-full object-cover"},null,8,Rt)):m("",!0)])):t(p).screen_image?(o(),l("img",{key:1,src:t(p).screen_image,alt:t(p).title,class:"w-full h-full object-cover"},null,8,Vt)):(o(),l("div",Et,[e("div",Ft,[n[5]||(n[5]=e("div",{class:"text-4xl mb-2"},"📺",-1)),e("p",At,c(t(p).title),1)])])),n[6]||(n[6]=e("div",{class:"absolute top-4 right-4 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-xs"}," Preview Mode ",-1))])]),e("div",Dt,[e("div",It,[n[17]||(n[17]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4 text-center"}," Пульт управления ",-1)),t(p).actions&&t(p).actions.length>0?(o(),l("div",Nt,[n[7]||(n[7]=e("h4",{class:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2"},"Выполните действия:",-1)),e("ol",zt,[(o(!0),l(S,null,U(t(p).actions,(f,k)=>(o(),l("li",{key:k,class:"flex items-center space-x-2"},[e("span",Bt,c(k+1),1),e("span",null,c(f.description),1)]))),128))])])):m("",!0),e("div",Pt,[e("div",Tt,[B(g,{"button-id":"power",highlighted:C("power"),class:"w-10 h-10 bg-red-600 rounded-full mx-auto"},{default:P(()=>n[8]||(n[8]=[q(" ⏻ ")])),_:1,__:[8]},8,["highlighted"]),n[9]||(n[9]=e("p",{class:"text-white text-xs mt-1"},"POWER",-1))]),e("div",qt,[B(g,{"button-id":"ok",highlighted:C("ok"),class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center"},{default:P(()=>n[10]||(n[10]=[e("span",{class:"text-white text-xs"},"OK",-1)])),_:1,__:[10]},8,["highlighted"]),B(g,{"button-id":"up",highlighted:C("up"),class:"absolute top-0 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-gray-700 rounded flex items-center justify-center"},{default:P(()=>n[11]||(n[11]=[q(" ↑ ")])),_:1,__:[11]},8,["highlighted"]),B(g,{"button-id":"down",highlighted:C("down"),class:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-gray-700 rounded flex items-center justify-center"},{default:P(()=>n[12]||(n[12]=[q(" ↓ ")])),_:1,__:[12]},8,["highlighted"]),B(g,{"button-id":"left",highlighted:C("left"),class:"absolute left-0 top-1/2 transform -translate-y-1/2 w-6 h-6 bg-gray-700 rounded flex items-center justify-center"},{default:P(()=>n[13]||(n[13]=[q(" ← ")])),_:1,__:[13]},8,["highlighted"]),B(g,{"button-id":"right",highlighted:C("right"),class:"absolute right-0 top-1/2 transform -translate-y-1/2 w-6 h-6 bg-gray-700 rounded flex items-center justify-center"},{default:P(()=>n[14]||(n[14]=[q(" → ")])),_:1,__:[14]},8,["highlighted"])]),e("div",Ht,[B(g,{"button-id":"menu",highlighted:C("menu"),class:"h-6 bg-purple-600 rounded text-white text-xs flex items-center justify-center"},{default:P(()=>n[15]||(n[15]=[q(" MENU ")])),_:1,__:[15]},8,["highlighted"]),B(g,{"button-id":"exit",highlighted:C("exit"),class:"h-6 bg-red-500 rounded text-white text-xs flex items-center justify-center"},{default:P(()=>n[16]||(n[16]=[q(" EXIT ")])),_:1,__:[16]},8,["highlighted"])]),e("div",Wt,[(o(),l(S,null,U(9,f=>B(g,{key:f,"button-id":`num-${f}`,highlighted:C(`num-${f}`),class:"h-6 bg-gray-700 rounded text-white text-xs flex items-center justify-center"},{default:P(()=>[q(c(f),1)]),_:2},1032,["button-id","highlighted"])),64))])])])])]),e("div",Gt,[e("div",Jt,[e("div",Kt,[e("h3",Xt,c(t(p).title),1),e("p",Zt,c(t(p).instruction),1),t(p).tip?(o(),l("div",Qt,[e("div",Yt,[n[18]||(n[18]=e("svg",{class:"w-5 h-5 text-blue-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("p",er,c(t(p).tip),1)])])):m("",!0),t(p).userConfirmation?(o(),l("div",tr,[e("h4",rr,c(t(p).userConfirmation.question),1),e("div",sr,[(o(!0),l(S,null,U(t(p).userConfirmation.options,f=>(o(),l("button",{key:f.text,class:"w-full text-left px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-yellow-300 dark:border-yellow-600 rounded hover:bg-yellow-100 dark:hover:bg-yellow-800 transition-colors"},c(f.text),1))),128))])])):m("",!0),t(p).ifNoResult?(o(),l("div",or,[e("div",lr,[n[20]||(n[20]=e("svg",{class:"w-5 h-5 text-purple-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),e("div",null,[n[19]||(n[19]=e("p",{class:"text-sm font-medium text-purple-800 dark:text-purple-200"}," Если не помогло: ",-1)),e("p",ar,c(t(p).ifNoResult.description),1)])])])):m("",!0)]),e("div",dr,[t(h)>0?(o(),l("button",{key:0,onClick:z,class:"btn-secondary"}," ← Назад ")):m("",!0),t(h)<t(O).length-1?(o(),l("button",{key:1,onClick:F,class:"btn-primary"}," Далее → ")):m("",!0)])])])])):(o(),l("div",ir,n[21]||(n[21]=[e("div",{class:"text-4xl mb-4"},"📋",-1),e("p",null,"Нет доступных шагов для предпросмотра",-1)])))])])])}}},ur=te(nr,[["__scopeId","data-v-02785763"]]),cr={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},pr={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8"},gr={class:"mt-4 lg:mt-0 flex space-x-3"},xr={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6"},mr={class:"lg:col-span-2"},yr={class:"relative"},br=["value"],fr=["value"],vr={key:0,class:"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-4"},hr={class:"flex items-center justify-between"},kr={class:"flex items-center space-x-4"},wr={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},_r={class:"card overflow-hidden"},$r={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Cr={class:"flex items-center justify-between"},Sr={class:"text-lg font-medium text-gray-900 dark:text-white"},Ur={class:"overflow-x-auto"},jr={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Or={class:"bg-gray-50 dark:bg-gray-800"},Mr={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Lr=["checked","indeterminate"],Rr={class:"bg-white dark:bg-dark-100 divide-y divide-gray-200 dark:divide-gray-700"},Vr=["onDragstart","onDrop"],Er={class:"px-6 py-4 whitespace-nowrap"},Fr=["value"],Ar={class:"px-6 py-4 whitespace-nowrap"},Dr={class:"flex items-center space-x-2"},Ir={class:"text-sm font-medium text-gray-900 dark:text-white"},Nr={class:"px-6 py-4"},zr={class:"flex items-start space-x-3"},Br=["src","alt"],Pr={key:1,class:"w-16 h-12 bg-gray-200 dark:bg-gray-700 rounded border flex items-center justify-center"},Tr={class:"flex-1"},qr={class:"flex items-center space-x-2"},Hr={class:"text-sm font-medium text-gray-900 dark:text-white"},Wr={key:0,class:"px-2 py-1 text-xs bg-orange-100 text-orange-800 dark:bg-orange-800 dark:text-orange-100 rounded-full"},Gr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Jr={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-1"},Kr={class:"px-6 py-4"},Xr={key:0,class:"space-y-1"},Zr={class:"w-6 h-6 bg-yellow-100 text-yellow-800 text-xs rounded flex items-center justify-center font-mono"},Qr={class:"text-xs text-gray-600 dark:text-gray-400"},Yr={key:0,class:"text-xs text-gray-500"},es={key:1,class:"flex space-x-1"},ts={key:0,class:"text-xs text-gray-500"},rs={key:2,class:"text-sm text-gray-400"},ss={class:"px-6 py-4"},os={class:"flex flex-wrap gap-1"},ls={key:0,class:"px-2 py-1 text-xs bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-100 rounded-full"},as={key:1,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 rounded-full"},ds={key:2,class:"px-2 py-1 text-xs bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100 rounded-full"},is={key:3,class:"px-2 py-1 text-xs bg-indigo-100 text-indigo-800 dark:bg-indigo-800 dark:text-indigo-100 rounded-full"},ns={class:"px-6 py-4"},us={class:"flex items-center space-x-2"},cs={key:0,class:"text-sm"},ps={key:1,class:"text-sm"},gs={key:2,class:"text-sm text-gray-400"},xs={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ms={class:"flex justify-end space-x-2"},ys=["onClick"],bs=["onClick"],fs=["onClick"],vs=["onClick"],hs={class:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6"},ks={class:"card p-6"},ws={class:"space-y-4"},_s={class:"flex justify-between items-center"},$s={class:"font-semibold text-gray-900 dark:text-white"},Cs={class:"flex justify-between items-center"},Ss={class:"font-semibold text-gray-900 dark:text-white"},Us={class:"flex justify-between items-center"},js={class:"font-semibold text-gray-900 dark:text-white"},Os={class:"flex justify-between items-center"},Ms={class:"font-semibold text-gray-900 dark:text-white"},Ls={class:"card p-6"},Rs={class:"space-y-3"},Vs={class:"flex-1 min-w-0"},Es={class:"text-sm text-gray-900 dark:text-white"},Fs={class:"text-xs text-gray-500 dark:text-gray-400"},Bs={__name:"steps",async setup(I){let $,v;const{data:h}=([$,v]=K(()=>X("/api/devices","$7bsdMxwMsE")),$=await $,v(),$),{data:R}=([$,v]=K(()=>X("/api/errors/all","$zttns_Z2zZ")),$=await $,v(),$),{data:a,refresh:O}=([$,v]=K(()=>X("/api/steps/all","$EYfSF6UOMh")),$=await $,v(),$),p=L(""),E=L(""),N=L(""),C=L("order"),F=L(!1),z=L(!1),w=L(!1),n=L(null),g=L([]),f=D(()=>E.value?(R.value||[]).filter(u=>u.device_id==E.value):R.value||[]),k=D(()=>{let u=a.value||[];if(p.value){const r=p.value.toLowerCase();u=u.filter(y=>y.title.toLowerCase().includes(r)||y.instruction.toLowerCase().includes(r))}return E.value&&(u=u.filter(r=>r.device_id==E.value)),N.value&&(u=u.filter(r=>r.error_id==N.value)),F.value||(u=u.filter(r=>!r.onlyForOperator)),C.value==="title"?u.sort((r,y)=>r.title.localeCompare(y.title)):C.value==="created"?u.sort((r,y)=>new Date(y.created_at)-new Date(r.created_at)):u.sort((r,y)=>r.order_index-y.order_index),u}),x=D(()=>(a.value||[]).length),s=D(()=>(a.value||[]).filter(u=>u.onlyForOperator).length),i=D(()=>(a.value||[]).filter(u=>u.ifNoResult).length),M=D(()=>(a.value||[]).filter(u=>u.media||u.audio_url).length),j=L([{id:1,description:'Пользователь прошел шаг "Проверка карты"',timestamp:"2 мин назад"},{id:2,description:'Пользователь застрял на шаге "Настройка антенны"',timestamp:"5 мин назад"},{id:3,description:"Завершена диагностика Openbox GOLD",timestamp:"10 мин назад"}]),re=()=>{F.value=!F.value},Q=u=>u?{power:"⏻",menu:"☰",ok:"✓",up:"↑",down:"↓",left:"←",right:"→",info:"ℹ",exit:"✕",source:"SRC"}[u]||u.toString().toUpperCase().slice(0,2):"?",se=u=>({image:"🖼️",video:"🎥",animation:"🎞️"})[u]||"📄",oe=u=>{n.value=u,z.value=!0},le=u=>{console.log("Preview step:",u)},ae=u=>{const r={...u,id:null,title:`${u.title} (копия)`};n.value=r,z.value=!0},de=async u=>{if(confirm(`Удалить шаг "${u.title}"?`))try{await $fetch(`/api/admin/step/${u.id}`,{method:"DELETE"}),await O()}catch(r){console.error("Failed to delete step:",r),alert("Ошибка при удалении шага")}},Y=()=>{z.value=!1,n.value=null},ie=async u=>{try{n.value&&n.value.id?await $fetch(`/api/admin/step/${n.value.id}`,{method:"PUT",body:u}):await $fetch("/api/admin/step",{method:"POST",body:u}),Y(),await O()}catch(r){console.error("Failed to save step:",r),alert("Ошибка при сохранении шага")}},ne=()=>{const u=JSON.stringify(k.value,null,2),r=new Blob([u],{type:"application/json"}),y=URL.createObjectURL(r),V=document.createElement("a");V.href=y,V.download="steps_export.json",document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(y)};let H=null;const ue=(u,r)=>{H=u,r.dataTransfer.effectAllowed="move",r.target.style.opacity="0.5"},ce=async(u,r)=>{if(r.preventDefault(),r.target.style.opacity="1",!(!H||H.id===u.id))try{const y=H.order_index,V=u.order_index;await $fetch("/api/admin/steps/reorder",{method:"POST",body:{draggedStepId:H.id,targetStepId:u.id,draggedIndex:y,targetIndex:V}}),await O()}catch(y){console.error("Failed to reorder steps:",y),alert("Ошибка при изменении порядка шагов")}finally{H=null}},pe=()=>{g.value.length===k.value.length?g.value=[]:g.value=k.value.map(u=>u.id)},ge=()=>{g.value=[]},xe=async()=>{const u=g.value.length;if(confirm(`Удалить ${u} выбранных шагов? Это действие нельзя отменить.`))try{await Promise.all(g.value.map(r=>$fetch(`/api/admin/step/${r}`,{method:"DELETE"}))),await O(),g.value=[]}catch(r){console.error("Failed to delete steps:",r),alert("Ошибка при удалении шагов")}},me=async()=>{const u=g.value.length;if(confirm(`Переключить режим "Только оператор" для ${u} выбранных шагов?`))try{const r=k.value.filter(y=>g.value.includes(y.id));await Promise.all(r.map(y=>$fetch(`/api/admin/step/${y.id}`,{method:"PUT",body:{...y,onlyForOperator:!y.onlyForOperator}}))),await O(),g.value=[]}catch(r){console.error("Failed to toggle operator mode:",r),alert("Ошибка при изменении режима оператора")}},ye=()=>{const u=k.value.filter(_=>g.value.includes(_.id)),r=JSON.stringify(u,null,2),y=new Blob([r],{type:"application/json"}),V=URL.createObjectURL(y),d=document.createElement("a");d.href=V,d.download=`selected_steps_${g.value.length}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(V)};return he({title:"Управление шагам�� - Админ-панель"}),(u,r)=>{const y=dt,V=ur;return o(),l("div",cr,[e("div",pr,[r[9]||(r[9]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Управление шагами диагностики"),e("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Создавайте и редактируйте пошаговые инструкции с продвинутыми функциями ")],-1)),e("div",gr,[e("button",{onClick:re,class:J(["px-4 py-2 rounded-lg font-medium transition-colors",t(F)?"bg-orange-600 text-white hover:bg-orange-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},c(t(F)?"👤 Режим оператора":"👥 Режим пользователя"),3),e("button",{onClick:r[0]||(r[0]=d=>w.value=!0),class:"btn-secondary"}," 👁️ Предпросмотр "),e("button",{onClick:r[1]||(r[1]=d=>z.value=!0),class:"btn-primary"}," + Добавить шаг ")])]),e("div",xr,[e("div",mr,[r[11]||(r[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Поиск по названию ",-1)),e("div",yr,[b(e("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>W(p)?p.value=d:null),type:"text",placeholder:"Введите название шага...",class:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,512),[[A,t(p)]]),r[10]||(r[10]=e("svg",{class:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})],-1))])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Приставка ",-1)),b(e("select",{"onUpdate:modelValue":r[3]||(r[3]=d=>W(E)?E.value=d:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},[r[12]||(r[12]=e("option",{value:""},"Все",-1)),(o(!0),l(S,null,U(t(h),d=>(o(),l("option",{key:d.id,value:d.id},c(d.name),9,br))),128))],512),[[T,t(E)]])]),e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Ошибка ",-1)),b(e("select",{"onUpdate:modelValue":r[4]||(r[4]=d=>W(N)?N.value=d:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},[r[14]||(r[14]=e("option",{value:""},"Все",-1)),(o(!0),l(S,null,U(t(f),d=>(o(),l("option",{key:d.id,value:d.id},c(d.title),9,fr))),128))],512),[[T,t(N)]])]),e("div",null,[r[17]||(r[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Сортировка ",-1)),b(e("select",{"onUpdate:modelValue":r[5]||(r[5]=d=>W(C)?C.value=d:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},r[16]||(r[16]=[e("option",{value:"order"},"По порядку",-1),e("option",{value:"title"},"По названию",-1),e("option",{value:"created"},"По дате создания",-1)]),512),[[T,t(C)]])])]),t(g).length>0?(o(),l("div",vr,[e("div",hr,[e("div",kr,[e("span",wr," Выбрано шагов: "+c(t(g).length),1),e("div",{class:"flex items-center space-x-2"},[e("button",{onClick:xe,class:"text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"}," 🗑️ Удалить выбранные "),e("button",{onClick:me,class:"text-sm text-orange-600 hover:text-orange-800 dark:text-orange-400 dark:hover:text-orange-300"},' 🔒 Переключить "Только оператор" '),e("button",{onClick:ye,class:"text-sm text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300"}," 📄 Экспортировать выбранные ")])]),e("button",{onClick:ge,class:"text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300"}," Отменить выбор ")])])):m("",!0),e("div",_r,[e("div",$r,[e("div",Cr,[e("h3",Sr," Шаги диагностики ("+c(t(k).length)+") ",1),e("div",{class:"flex items-center space-x-2"},[r[18]||(r[18]=e("span",{class:"text-sm text-gray-500"},"Drag & Drop для изменения порядка",-1)),e("button",{onClick:ne,class:"text-sm text-primary-600 hover:text-primary-700"}," 📄 Экспорт ")])])]),e("div",Ur,[e("table",jr,[e("thead",Or,[e("tr",null,[e("th",Mr,[e("input",{type:"checkbox",checked:t(g).length===t(k).length&&t(k).length>0,indeterminate:t(g).length>0&&t(g).length<t(k).length,onChange:pe,class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,40,Lr)]),r[19]||(r[19]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Порядок ",-1)),r[20]||(r[20]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Название и описание ",-1)),r[21]||(r[21]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Кнопки пульта ",-1)),r[22]||(r[22]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Особенности ",-1)),r[23]||(r[23]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Медиа ",-1)),r[24]||(r[24]=e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Действия ",-1))])]),e("tbody",Rr,[(o(!0),l(S,null,U(t(k),d=>(o(),l("tr",{key:d.id,class:J([{"opacity-50":d.onlyForOperator&&!t(F)},"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-move"]),draggable:"true",onDragstart:_=>ue(d,_),onDragover:r[7]||(r[7]=Z(()=>{},["prevent"])),onDrop:_=>ce(d,_)},[e("td",Er,[b(e("input",{type:"checkbox",value:d.id,"onUpdate:modelValue":r[6]||(r[6]=_=>W(g)?g.value=_:null),class:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"},null,8,Fr),[[G,t(g)]])]),e("td",Ar,[e("div",Dr,[e("span",Ir,c(d.order_index),1),r[25]||(r[25]=e("button",{class:"text-gray-400 hover:text-gray-600 cursor-move"},[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M7 2a1 1 0 000 2h6a1 1 0 100-2H7zM7 8a1 1 0 000 2h6a1 1 0 100-2H7zM7 14a1 1 0 000 2h6a1 1 0 100-2H7z"})])],-1))])]),e("td",Nr,[e("div",zr,[d.screen_image?(o(),l("img",{key:0,src:d.screen_image,alt:d.title,class:"w-16 h-12 object-cover rounded border"},null,8,Br)):(o(),l("div",Pr,r[26]||(r[26]=[e("span",{class:"text-gray-400 text-xs"},"Нет фото",-1)]))),e("div",Tr,[e("div",qr,[e("h4",Hr,c(d.title),1),d.onlyForOperator?(o(),l("span",Wr," 🔒 Оператор ")):m("",!0)]),e("p",Gr,c(d.instruction),1),d.tip?(o(),l("p",Jr," 💡 "+c(d.tip),1)):m("",!0)])])]),e("td",Kr,[d.actions&&d.actions.length>0?(o(),l("div",Xr,[(o(!0),l(S,null,U(d.actions.slice(0,3),_=>(o(),l("div",{key:_.buttonId,class:"flex items-center space-x-2"},[e("span",Zr,c(Q(_.buttonId)),1),e("span",Qr,c(_.description),1)]))),128)),d.actions.length>3?(o(),l("div",Yr," +"+c(d.actions.length-3)+" еще... ",1)):m("",!0)])):d.highlighted_buttons&&d.highlighted_buttons.length>0?(o(),l("div",es,[(o(!0),l(S,null,U(d.highlighted_buttons.slice(0,4),_=>(o(),l("span",{key:_,class:"w-6 h-6 bg-yellow-100 text-yellow-800 text-xs rounded flex items-center justify-center font-mono"},c(Q(_)),1))),128)),d.highlighted_buttons.length>4?(o(),l("span",ts," +"+c(d.highlighted_buttons.length-4),1)):m("",!0)])):(o(),l("span",rs,"Нет кнопок"))]),e("td",ss,[e("div",os,[d.ifNoResult?(o(),l("span",ls," 🔄 Альтернатива ")):m("",!0),d.userConfirmation?(o(),l("span",as," ❓ Подтверждение ")):m("",!0),d.validation?(o(),l("span",ds," ✅ Валидация ")):m("",!0),d.progress?(o(),l("span",is," ⏳ Прогресс ")):m("",!0)])]),e("td",ns,[e("div",us,[d.media?(o(),l("span",cs,c(se(d.media.type))+" "+c(d.media.type),1)):m("",!0),d.audio_url?(o(),l("span",ps,"🔊 Аудио")):m("",!0),!d.media&&!d.audio_url?(o(),l("span",gs,"Нет медиа")):m("",!0)])]),e("td",xs,[e("div",ms,[e("button",{onClick:_=>le(d),class:"text-blue-600 hover:text-blue-900 transition-colors",title:"Предпросмотр"}," 👁️ ",8,ys),e("button",{onClick:_=>oe(d),class:"text-indigo-600 hover:text-indigo-900 transition-colors",title:"Редактировать"}," ✏️ ",8,bs),e("button",{onClick:_=>ae(d),class:"text-green-600 hover:text-green-900 transition-colors",title:"Дублировать"}," 📋 ",8,fs),e("button",{onClick:_=>de(d),class:"text-red-600 hover:text-red-900 transition-colors",title:"Удалить"}," 🗑️ ",8,vs)])])],42,Vr))),128))])])])]),t(z)||t(n)?(o(),ee(y,{key:1,step:t(n),devices:t(h),errors:t(R),onClose:Y,onSave:ie},null,8,["step","devices","errors"])):m("",!0),t(w)?(o(),ee(V,{key:2,steps:t(k),"operator-mode":t(F),onClose:r[8]||(r[8]=d=>w.value=!1)},null,8,["steps","operator-mode"])):m("",!0),e("div",hs,[e("div",ks,[r[31]||(r[31]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 📊 Аналитика шагов ",-1)),e("div",ws,[e("div",_s,[r[27]||(r[27]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Всего шагов:",-1)),e("span",$s,c(t(x)),1)]),e("div",Cs,[r[28]||(r[28]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Только для операторов:",-1)),e("span",Ss,c(t(s)),1)]),e("div",Us,[r[29]||(r[29]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"С альтернативами:",-1)),e("span",js,c(t(i)),1)]),e("div",Os,[r[30]||(r[30]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"С мед��а:",-1)),e("span",Ms,c(t(M)),1)])])]),e("div",Ls,[r[33]||(r[33]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 📋 Последние действия пользователей ",-1)),e("div",Rs,[(o(!0),l(S,null,U(t(j),d=>(o(),l("div",{key:d.id,class:"flex items-center space-x-3"},[r[32]||(r[32]=e("div",{class:"w-2 h-2 bg-green-400 rounded-full"},null,-1)),e("div",Vs,[e("p",Es,c(d.description),1),e("p",Fs,c(d.timestamp),1)])]))),128))]),r[34]||(r[34]=e("button",{class:"mt-4 w-full text-sm text-primary-600 hover:text-primary-700"}," Посмотреть все логи → ",-1))])])])}}};export{Bs as default};
