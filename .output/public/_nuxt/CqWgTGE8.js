import{_ as tt}from"./D4a6TBNS.js";import{_ as et}from"./BxAFrtwI.js";import{f as st,i as ot,j as v,k as O,e as S,r as x,l as lt,u as it,c as a,a as t,b as V,w as nt,t as i,g as o,h as _,F as B,m as R,n as T,o as c,d as at,v as ct,x as dt,A as rt,z as ut}from"./sX_wM5Ua.js";import{u as gt}from"./Hx5HSeAH.js";import{u as j}from"./bGbag7Rw.js";import"./DlAUqK2U.js";import"./BHIvy5Tm.js";import"./DTcQ41cH.js";const mt={class:"min-h-screen bg-gradient-to-br from-gray-800 to-gray-900 p-4"},vt={class:"max-w-7xl mx-auto"},xt={class:"mb-8"},pt={class:"flex items-center space-x-2 text-sm text-gray-400 mb-4"},_t={class:"text-white"},ht={class:"flex items-center justify-between"},bt={class:"text-4xl font-bold text-white mb-2"},yt={class:"text-gray-300"},ft={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},wt={class:"lg:col-span-1 flex justify-center"},kt={class:"space-y-6"},Ct={key:0,class:"text-center"},$t=["src","alt"],Bt={key:0,class:"text-xs text-gray-400 mt-2"},Rt={class:"lg:col-span-2 space-y-6"},Et={class:"bg-gray-800 p-6 rounded-xl"},Ut={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Dt=["onClick"],It={class:"flex items-center space-x-3"},Lt={class:"text-2xl"},Nt={class:"font-medium"},Ot={class:"text-sm opacity-75"},St={key:1,class:"text-gray-400 text-center py-8"},Vt={key:0,class:"bg-gray-800 p-6 rounded-xl"},Tt={class:"flex items-center justify-between mb-4"},jt={class:"text-xl font-semibold text-white"},Mt={class:"bg-gray-700 p-4 rounded-lg"},At={class:"text-gray-300 mb-3"},Ft={class:"flex items-center space-x-4 text-sm"},Ht={class:"text-blue-400"},zt={class:"text-green-400"},Kt={class:"bg-gray-800 p-6 rounded-xl"},Pt={class:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4"},Qt={class:"mb-4"},qt={class:"grid grid-cols-3 md:grid-cols-5 gap-2"},Wt=["value"],Xt={class:"bg-gray-800 p-6 rounded-xl"},Yt={class:"max-h-48 overflow-y-auto"},Gt={key:0,class:"text-gray-400 text-center py-4"},Jt={class:"flex items-center justify-between"},Zt={class:"text-blue-400"},te={key:0,class:"text-yellow-400 text-xs"},ee={class:"mt-1"},ge={__name:"[deviceId]",async setup(se){let d,h;const M=st(),A=ot(),k=gt(),g=v(()=>M.params.deviceId),{data:F}=([d,h]=O(()=>j("/api/devices","$mOQLVqI99h")),d=await d,h(),d),n=v(()=>{var s;return(s=F.value)==null?void 0:s.find(e=>e.id==g.value)});S(async()=>{await k.loadSettings()});const E=v(()=>{var s,e,w;return((s=n.value)==null?void 0:s.display_remote)||((e=n.value)==null?void 0:e.remote_image)||((w=k.getDefaultRemote.value)==null?void 0:w.url)||null}),H=v(()=>{var s;return!((s=n.value)!=null&&s.remote_image)&&k.getDefaultRemote.value}),{data:U}=([d,h]=O(()=>j(`/api/errors/${g.value}`,"$lHUQUUAStY")),d=await d,h(),d),C=x([]),r=x(null),$=x([]),b=x([]),p=x([]),u=x([]),z=[{id:"power",label:"POWER"},{id:"source",label:"SOURCE"},{id:"menu",label:"MENU"},{id:"ok",label:"OK"},{id:"up",label:"↑"},{id:"down",label:"↓"},{id:"left",label:"←"},{id:"right",label:"→"},{id:"back",label:"BACK"},{id:"info",label:"INFO"},{id:"exit",label:"EXIT"},{id:"vol-up",label:"VOL+"},{id:"vol-down",label:"VOL-"},{id:"ch-up",label:"CH+"},{id:"ch-down",label:"CH-"}],K=async s=>{r.value=s;try{const e=await $fetch(`/api/steps/${g.value}/${s.id}`);C.value=e,f(`Выбрана ошибка: ${s.title}`)}catch(e){console.error("Failed to load steps:",e),C.value=[]}},P=()=>{r.value&&T(`/error/${g.value}/${r.value.id}`)},y=s=>{$.value=[...s],f(`Подсвечены кнопки: ${s.join(", ")}`)},Q=()=>{$.value=[],b.value=[],p.value=[],f("Подсветка очищена")},q=s=>{b.value.includes(s)||b.value.push(s),f(`Нажата кнопка: ${s}`,s)},f=(s,e=null)=>{u.value.unshift({message:s,buttonId:e,timestamp:new Date}),u.value.length>50&&(u.value=u.value.slice(0,50))},W=()=>{u.value=[]},X=s=>s.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),Y=s=>({high:"Высокая",medium:"Средняя",low:"Низкая"})[s]||"Обычная",G=()=>{T(`/tv/${g.value}`)},J=()=>{A.back()};return S(()=>{if(!n.value)throw lt({statusCode:404,statusMessage:`Устройство с ID ${g.value} не найдено`})}),it({title:v(()=>n.value?`Пульт ${n.value.name}`:"Пульт управления"),meta:[{name:"description",content:v(()=>n.value?`Интерактивный пульт управления для ${n.value.name}`:"Интерактивный пульт управления")}]}),(s,e)=>{var D,I,L,N;const w=tt,Z=et;return c(),a("div",mt,[t("div",vt,[t("div",xt,[t("nav",pt,[V(w,{to:"/",class:"hover:text-white"},{default:nt(()=>e[5]||(e[5]=[at("Главная")])),_:1,__:[5]}),e[6]||(e[6]=t("span",null,"→",-1)),t("span",_t,i(((D=o(n))==null?void 0:D.name)||"Пульт управления"),1)]),t("div",ht,[t("div",null,[t("h1",bt," 🎮 "+i(((I=o(n))==null?void 0:I.name)||"Устройство"),1),t("p",yt,i(((L=o(n))==null?void 0:L.description)||"Интерактивный пульт управления"),1)]),t("div",{class:"flex space-x-3"},[t("button",{onClick:G,class:"btn-primary"}," 📺 Открыть ТВ "),t("button",{onClick:J,class:"btn-secondary"}," ← Назад ")])])]),t("div",ft,[t("div",wt,[t("div",kt,[o(E)?(c(),a("div",Ct,[t("img",{src:o(E),alt:`Пульт ${((N=o(n))==null?void 0:N.name)||"устройства"}`,class:"max-w-xs mx-auto rounded-lg shadow-lg"},null,8,$t),o(H)?(c(),a("p",Bt," Пульт по умолчанию ")):_("",!0)])):_("",!0),V(Z,{device:o(n),"highlighted-buttons":o($),"completed-actions":o(b),onButtonPress:q},null,8,["device","highlighted-buttons","completed-actions"])])]),t("div",Rt,[t("div",Et,[e[7]||(e[7]=t("h3",{class:"text-xl font-semibold text-white mb-4"},"Выбор проблемы",-1)),o(U).length>0?(c(),a("div",Ut,[(c(!0),a(B,null,R(o(U),l=>{var m;return c(),a("button",{key:l.id,onClick:oe=>K(l),class:ct(["p-4 rounded-lg text-left transition-colors",((m=o(r))==null?void 0:m.id)===l.id?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"])},[t("div",It,[t("span",Lt,i(l.icon||"⚠️"),1),t("div",null,[t("h4",Nt,i(l.title),1),t("p",Ot,i(l.description),1)])])],10,Dt)}),128))])):(c(),a("div",St," Ошибки для этого устройства не найдены "))]),o(r)?(c(),a("div",Vt,[t("div",Tt,[t("h3",jt," Диагностика: "+i(o(r).title),1),t("button",{onClick:P,class:"btn-primary"}," 🚀 Начать решение ")]),t("div",Mt,[t("p",At,i(o(r).description),1),t("div",Ft,[t("span",Ht," Шагов: "+i(o(C).length||0),1),t("span",zt," Сложность: "+i(Y(o(r).severity)),1)])])])):_("",!0),t("div",Kt,[e[9]||(e[9]=t("h3",{class:"text-xl font-semibold text-white mb-4"},"Управление подсветкой",-1)),t("div",Pt,[t("button",{onClick:e[0]||(e[0]=l=>y(["menu","ok"])),class:"p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"}," MENU + OK "),t("button",{onClick:e[1]||(e[1]=l=>y(["up","down","ok"])),class:"p-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"}," Навигация "),t("button",{onClick:e[2]||(e[2]=l=>y(["info"])),class:"p-3 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors text-sm"}," INFO "),t("button",{onClick:Q,class:"p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm"}," Очистить ")]),t("div",Qt,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Выберите кнопки для подсветки: ",-1)),t("div",qt,[(c(),a(B,null,R(z,l=>t("label",{key:l.id,class:"flex items-center space-x-2 text-xs text-gray-300"},[dt(t("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":e[3]||(e[3]=m=>ut(p)?p.value=m:null),class:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"},null,8,Wt),[[rt,o(p)]]),t("span",null,i(l.label),1)])),64))])]),t("button",{onClick:e[4]||(e[4]=l=>y(o(p))),class:"w-full p-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"}," Применить подсветку ")]),t("div",Xt,[t("div",{class:"flex items-center justify-between mb-4"},[e[10]||(e[10]=t("h3",{class:"text-xl font-semibold text-white"},"Лог действий",-1)),t("button",{onClick:W,class:"text-sm text-gray-400 hover:text-white"}," Очистить ")]),t("div",Yt,[o(u).length===0?(c(),a("div",Gt," Действия будут отображаться здесь ")):_("",!0),(c(!0),a(B,null,R(o(u),(l,m)=>(c(),a("div",{key:m,class:"mb-2 p-3 bg-gray-700 rounded text-sm text-gray-300"},[t("div",Jt,[t("span",Zt,i(X(l.timestamp)),1),l.buttonId?(c(),a("span",te,i(l.buttonId.toUpperCase()),1)):_("",!0)]),t("div",ee,i(l.message),1)]))),128))])])])])])])}}};export{ge as default};
