import{_ as $}from"./D4a6TBNS.js";import{k as z,r as m,u as D,c as u,a as e,h as j,F as L,m as B,g as a,D as y,t as l,x as b,C as v,o as c,b as E,w as H,d as N}from"./sX_wM5Ua.js";import{u as T}from"./bGbag7Rw.js";import"./BHIvy5Tm.js";import"./DTcQ41cH.js";const F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},U={class:"flex justify-between items-center mb-8"},S={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},q={class:"flex items-center justify-between mb-4"},A={class:"flex space-x-2"},O=["onClick"],P=["onClick"],I={class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"},X={class:"text-gray-600 dark:text-gray-400 text-sm mb-4"},G={class:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400"},J={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},K={class:"inline-block align-bottom bg-white dark:bg-dark-100 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Q={class:"bg-white dark:bg-dark-100 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},R={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4"},W={class:"space-y-4"},Y={class:"bg-gray-50 dark:bg-gray-800 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Z=["disabled"],ie={__name:"devices",async setup(ee){let n,x;const{data:h,refresh:f}=([n,x]=z(()=>T("/api/devices","$HL0Di_pgq5")),n=await n,x(),n),p=m(!1),i=m(null),d=m(!1),o=m({name:"",description:"",remote_image:null}),w=r=>{i.value=r,o.value={name:r.name,description:r.description,remote_image:r.remote_image}},g=()=>{p.value=!1,i.value=null,o.value={name:"",description:"",remote_image:null}},k=r=>{const t=r.target.files[0];t&&(o.value.remote_image=t.name)},_=async()=>{d.value=!0;try{i.value?await $fetch(`/api/admin/device/${i.value.id}`,{method:"PUT",body:o.value}):await $fetch("/api/admin/device",{method:"POST",body:o.value}),await f(),g()}catch(r){console.error("Error saving device:",r),alert("Ошибка при сохранении приставки")}d.value=!1},C=async r=>{if(confirm(`Вы уверены, что хотите удалить приставку "${r.name}"?`))try{await $fetch(`/api/admin/device/${r.id}`,{method:"DELETE"}),await f()}catch(t){console.error("Error deleting device:",t),alert("Ошибка при удалении приставки")}};return D({title:"Управление приставками - Админ-панель"}),(r,t)=>{const M=$;return c(),u("div",F,[e("div",U,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Управление приставками"),e("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Добавляйте, редактируйте и удаляйте типы ТВ-приставок ")],-1)),e("button",{onClick:t[0]||(t[0]=s=>p.value=!0),class:"btn-primary"}," + Добавить приставку ")]),e("div",S,[(c(!0),u(L,null,B(a(h),s=>(c(),u("div",{key:s.id,class:"card p-6 hover:shadow-xl transition-shadow"},[e("div",q,[t[7]||(t[7]=e("div",{class:"w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})])],-1)),e("div",A,[e("button",{onClick:V=>w(s),class:"p-2 text-gray-400 hover:text-blue-600 transition-colors",title:"Редактировать"},t[5]||(t[5]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]),8,O),e("button",{onClick:V=>C(s),class:"p-2 text-gray-400 hover:text-red-600 transition-colors",title:"Удалить"},t[6]||(t[6]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,P)])]),e("h3",I,l(s.name),1),e("p",X,l(s.description),1),e("div",G,[e("span",null,l(s.error_count||0)+" ошибок",1),E(M,{to:`/admin/errors?device=${s.id}`,class:"text-primary-600 hover:text-primary-700 transition-colors"},{default:H(()=>t[8]||(t[8]=[N(" Управлять ошибками → ")])),_:2,__:[8]},1032,["to"])])]))),128))]),a(p)||a(i)?(c(),u("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:g},[e("div",J,[t[13]||(t[13]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",K,[e("form",{onSubmit:y(_,["prevent"]),onClick:t[3]||(t[3]=y(()=>{},["stop"]))},[e("div",Q,[e("h3",R,l(a(i)?"Редактировать приставку":"Добавить приставку"),1),e("div",W,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a(o).name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"Например: Openbox X1"},null,512),[[v,a(o).name]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),b(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white",placeholder:"Краткое описание приставки"},null,512),[[v,a(o).description]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Изображение пульта ",-1)),e("input",{type:"file",accept:"image/*",onChange:k,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,32),t[12]||(t[12]=e("p",{class:"text-xs text-gray-500 mt-1"}," Загрузите изображение пульта для этой приставки ",-1))])])]),e("div",Y,[e("button",{type:"submit",disabled:a(d),class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm"},l(a(d)?"Сохранение...":"Сохранить"),9,Z),e("button",{type:"button",onClick:g,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"}," Отмена ")])],32)])])])):j("",!0)])}}};export{ie as default};
